<div class="container mt-5">
  <h2 class="mb-5 text-center" style="margin-top: 160px">
    Generaci√≥n de Documentos
  </h2>

  <!-- Para que se muestre el cargador mientras se genera el PDF -->
  <div
    *ngIf="isLoading"
    class="position-fixed top-0 start-0 w-100 vh-100 bg-dark bg-opacity-50 d-flex align-items-center justify-content-center"
    style="z-index: 2000"
  >
    <div class="bg-light bg-opacity-75 p-4 rounded shadow">
      <div class="d-flex flex-column align-items-center">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Cargando...</span>
        </div>
        <p class="mt-3 fs-5 text-dark">
          Generando documentos, por favor espera...
        </p>
      </div>
    </div>
  </div>

  <!-- Fila 1: 2 tarjetas -->
  <div class="row g-4 mb-4">
    <div class="col-lg-6 col-md-6">
      <div class="card h-100 shadow-sm">
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">Proyecto T√©cnico</h5>
          <p class="card-text flex-grow-1">
            Documento base que describe la reforma realizada, sus
            caracter√≠sticas t√©cnicas y todos los datos del veh√≠culo implicados
            en el proceso.
          </p>
          <button
            class="btn btn-primary mt-auto w-100"
            (click)="generar('proyecto')"
          >
            Generar Proyecto T√©cnico
          </button>
        </div>
      </div>
    </div>

    <div class="col-lg-6 col-md-6">
      <div class="card h-100 shadow-sm">
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">Certificado Final de Obra</h5>
          <p class="card-text flex-grow-1">
            Certificado emitido por el t√©cnico competente, que garantiza que la
            reforma ha sido ejecutada seg√∫n el proyecto t√©cnico y cumple con la
            normativa.
          </p>
          <button
            class="btn btn-primary mt-auto w-100"
            (click)="generar('certificado-obra')"
          >
            Generar Certificado Final de Obra
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Fila 2: 3 tarjetas centradas -->
  <div class="row g-4 mb-5 justify-content-center">
    <div class="col-lg-4 col-md-6">
      <div class="card h-100 shadow-sm">
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">Certificado de Taller</h5>
          <p class="card-text flex-grow-1">
            Documento emitido por el taller instalador donde se certifica que la
            reforma fue efectuada conforme a la reglamentaci√≥n vigente.
          </p>
          <button
            class="btn btn-primary mt-auto w-100"
            (click)="generar('certificado-taller')"
          >
            Generar Certificado de Taller
          </button>
        </div>
      </div>
    </div>

    <div class="col-lg-4 col-md-6">
      <div class="card h-100 shadow-sm">
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">Declaraci√≥n Responsable</h5>
          <p class="card-text flex-grow-1">
            Declaraci√≥n firmada por el propietario o t√©cnico responsable,
            asumiendo que los datos facilitados y los trabajos realizados son
            veraces.
          </p>
          <button
            class="btn btn-primary mt-auto w-100"
            data-bs-toggle="modal"
            data-bs-target="#modalDeclaracion"
          >
            Generar Declaraci√≥n Responsable
          </button>
        </div>
      </div>
    </div>

    <div class="col-lg-4 col-md-6">
      <div class="card h-100 shadow-sm">
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">Memoria T√©cnica</h5>
          <p class="card-text flex-grow-1">
            Documento detallado con c√°lculos, planos y justificaci√≥n t√©cnica que
            soporta el proyecto de reforma.
          </p>
          <button
            class="btn btn-primary mt-auto w-100"
            (click)="generar('memoria-tecnica')"
          >
            Generar Memoria T√©cnica
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Botones de acci√≥n -->
  <div class="d-flex justify-content-end gap-2">
    <button class="btn btn-success" (click)="guardarDB()">
      Guardar Proyecto en Base de Datos
    </button>
    <button class="btn btn-outline-secondary" (click)="volver()">
      ‚Üê Volver al formulario
    </button>
  </div>
</div>

<!-- üîπ Modal Declaraci√≥n Responsable -->
<div
  class="modal fade"
  id="modalDeclaracion"
  tabindex="-1"
  aria-labelledby="modalDeclaracionLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalDeclaracionLabel">
          Selecciona la Comunidad Aut√≥noma
        </h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Cerrar"
        ></button>
      </div>
      <div class="modal-body text-center">
        <p>Elige para qu√© comunidad quieres generar la declaraci√≥n:</p>
        <div class="d-flex flex-column gap-3">
          <button
            class="btn btn-outline-primary"
            (click)="generarDeclaracion('valenciana')"
            data-bs-dismiss="modal"
          >
            Comunidad Valenciana
          </button>
          <button
            class="btn btn-outline-primary"
            (click)="generarDeclaracion('murcia')"
            data-bs-dismiss="modal"
          >
            Regi√≥n de Murcia
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
